

## 5.1 单调函数的可微性



**定义**. 设 $\mathcal{B}$ 是 $\mathbb{R}^{n}$ 中的一族球, $E$ 是 $\mathbb{R}^{n}$ 中的集合, 若对于 $\forall x\in E$, $\forall \delta\gt 0$, 存在球 $I\in \mathcal{B}$, $r(I)\leq \delta$, 使得 $x\in I$, 则称 $\mathcal{B}$ 为 $E$ 的 Vitali 覆盖.

若 $\mathcal{B}$ 是 $\mathbb{R}^{n}$ 中的一族闭球, 且含于开集 $G$, $m^{*}(G)\lt \infty$. 显然闭球的半径是有界的, 即 $\sup\limits_{B\in \mathcal{B}}r(B)\lt \infty$, 为叙述方便, 将其记为 $D$. 可以找到一个 $\mathcal{B}$ 的一个有限子集 $\mathcal{B}_{1}=\{B_{1,i}\}$, 满足: (1) $\frac{D}{2^{1}}\leq r(B_{1,i})\leq D$, $\forall i$; (2) $B_{1,i}\cap B_{1,j}=\emptyset$, $\forall i\neq j$; (3) 对于$\mathcal{B}$ 中任何不含于 $\mathcal{B}_{1}$ 且半径介于 $\frac{D}{2^{1}}$ 和 $D$ 的闭球 (如果存在的话), 一定和 $\mathcal{B}_{1}$ 中的某个闭球有交集. 构造过程如下: 在闭球集 $\mathcal{B}$ 中寻找半径介于 $\frac{D}{2^{1}}$ 和 $D$ 的闭球 $B_{1,1}$, 由上确界的定义, 这样的闭球一定存在, 将其收录进 $\mathcal{B}_{1}$, 继续寻找半径介于 $\frac{D}{2^{1}}$ 和 $D$ 的闭球, 此时要求不得与 $B_{1}^{1}$ 相交, 如果存在则记为 $B_{1,2}$, 依次继续进行下去, 每一次都要求新加入的闭球不得与之前找到的闭球相交. 因为 $m^{*}(G)\lt \infty$, 所以这样的搜寻过程至多只能进行有限次, 最终得到 $\mathcal{B}_{1}$. 进而还可以得到 $\mathcal{B}_{n}=\{B_{n,i}\}$, 满足: (1) $\frac{D}{2^{n}}\leq r(B_{n,i})\leq \frac{D}{2^{n-1}}$, $\forall i$; (2) $B_{n,i}\cap B_{n,j}=\emptyset$, $\forall i\neq j$; (3) 对于$\mathcal{B}$ 中任何不含于 $\mathcal{B}_{n}$ 且半径介于 $\frac{D}{2^{n}}$ 和 $\frac{D}{2^{n-1}}$ 的闭球 (如果存在的话), 一定和 $\mathcal{B}_{n}$ 中的某个闭球有交集, (4) $\mathcal{B}_{n}$ 中的闭球和 $\mathcal{B}_{1},\dots, \mathcal{B}_{n-1}$ 中的闭球不相交. (搜索方法相同, 只是搜寻时还要额外要求找到的闭球和 $\mathcal{B}_{1},\dots, \mathcal{B}_{n-1}$ 中的闭球也不相交, 如果搜索不到可以为空集.) 这样就得到了一个可数的闭球列 $\hat{\mathcal{B}}=\{\mathcal{B}_{1}, \mathcal{B}_{2}, \dots\}$. 对于任意 $B\in \mathcal{B}$ 且 $B\notin \mathcal{B}_{n}$, $\forall n$, 若 $\frac{D}{2^{k}}\leq r(B)\leq \frac{D}{2^{k-1}}$, 则 $B$ 必然与 $\mathcal{B}_{1}, \dots, \mathcal{B}_{k}$ 中的至少一个闭球有交集, 否则 $\mathcal{B}_{k}$ 不满足(3). 假设和闭球 $B'$ 有交集, 则对于 $B$ 上的任意一点 $x$,易证 $x$ 到 $B'$ 的中心 $c_{B'}$ 的距离满足
$$
d(x,c_{B'}) \leq 2r(B)+r(B')
$$
由于 $r(B')\geq \frac{D}{2^{k}}$, 所以
$$
\frac{r(B)}{r(B')}\leq \frac{r(B)}{\frac{D}{2^{k}}}\leq \frac{\frac{D}{2^{k}}}{\frac{D}{2^{k}}}=2
$$
因此 $d(x,c_{B'})\leq 5r(B')$, 即把 $B'$ 的半径扩张 $5$ 倍, 能够包括 $B$.

参考: https://zhuanlan.zhihu.com/p/26821322

**定理5.1.1**. (Vitali) 设 $E\subset \mathbb{R}^{d}$, 其外测度 $m^{*}(E)\lt \infty$, $\mathcal{B}$ 是 $E$ 的 Vitali 覆盖, 且其中的球体全部为闭球, 则对于 $\forall \epsilon\gt 0$, 存在有限个 $\mathcal{B}$ 中的闭球 $I_{1}, \dots I_{n}\in \mathcal{B}$, 使得
$$
m^{*}(E-\bigcup\limits_{i=1}^{n}I_{i})\lt \epsilon
$$
证明: 易证存在开集 $G\supset E$, 使得 $m(G)\lt \infty$. 对于 $\forall x\in E$, 显然 $x\in G$, 进而存在 $\delta\gt 0$, 使得 $U(x,\delta)\subset G$,  由 Vitali 覆盖的定义可知, 对于 $\forall \delta'\in (0, \frac{\delta}{3})$, 存在 $I\in \mathcal{B}$, $r(I)\leq \delta'$, 使得 $x\in I$, 此时 $I\subset G$. 由此易证若去除掉 $\mathcal{B}$ 中没有包含于 $G$ 的闭球, 得到的闭球集仍构成 $E$ 的 Vitali 覆盖, 记为 $\mathcal{B}_{G}$, 显然 $\mathcal{B}_{G}$ 中所有闭球的半径有界, 记 $D=\sup\limits_{B\in \mathcal{B}_{G}}r(B)$. 可以按照引言中的方法, 可以构造一个 $\hat{\mathcal{B}}$, 记 $\hat{\mathcal{B}}=\{\mathcal{B}_{1}, \mathcal{B}_{2}, \dots\}$, 则 $\sum\limits_{i=1}^{\infty}m(\mathcal{B}_{i})\lt m(G)\lt \infty$, 因此对于 $\forall \epsilon'\gt 0$, 必然存在 $n$ 使得
$$
\sum\limits_{i=n+1}^{\infty}m(\mathcal{B}_{i})\lt \epsilon'
$$
此时, 对于 $\forall x \in \big(G-\bigcup\limits_{i=1}^{n}\mathcal{B}_{i}\big)$, 可知 $\bigcup\limits_{i=1}^{n}\mathcal{B}_{i}$ 是闭集, 进而 $\big(G-\bigcup\limits_{i=1}^{n}\mathcal{B}_{i}\big)$ 是开集, 所以存在 $\delta''\gt 0$, 使得 $U(x, \delta'')\subset \big(G-\bigcup\limits_{i=1}^{n}\mathcal{B}_{i}\big)$, 由 Vitali 覆盖的定义可知, 存在 $\mathcal{B}_{G}$ 中的闭球 $I'$, $r(I')\lt \min(\frac{D}{2^{n}},\frac{\delta''}{3})$, 使得 $x\in I'$, 此时 $I'\subset U(x, \delta'')\subset \big(G-\bigcup\limits_{i=1}^{n}\mathcal{B}_{i}\big)$. 设 $\frac{D}{2^{k}}\leq r(I')\leq \frac{D}{2^{k-1}}$, $k\gt n$, 则根据引言中的分析, 存在  $\mathcal{B}_{1}, \dots, \mathcal{B}_{k}$ 中的一个闭球 $J$ 与 $I'$ 相交, 且 $J$ 扩张 $5$ 倍可包括 $I'$, 显然  $I'$  与 $\mathcal{B}_{1}, \dots, \mathcal{B}_{n}$ 全部无交集, 所以 $J\in \bigcup\limits_{i=n+1}^{k}\mathcal{B}_{i}$. 因此 $x\in I'\subset \bigcup\limits_{i=n+1}^{k}\mathcal{B}_{n+1}^{5r}\subseteq \bigcup\limits_{i=n+1}^{\infty}\mathcal{B}_{n+1}^{5r}$, (其中 $\mathcal{B}_{i}^{5r}$ 表示把 $\mathcal{B}_{i}$ 中的每个闭球扩张成5倍), 进而有 $\big(G-\bigcup\limits_{i=1}^{n}\mathcal{B}_{i}\big)\subset \bigcup\limits_{i=n+1}^{\infty}\mathcal{B}_{n+1}^{5r}$, $m\big(G-\bigcup\limits_{i=1}^{n}\mathcal{B}_{i}\big)\leq 5^{d}\epsilon'$.

特别地, 对于满足 $\epsilon'\leq \frac{\epsilon}{5^{d}}$, 此时
$$
m\big(G-\bigcup\limits_{i=1}^{n}\mathcal{B}_{i}\big)\leq \epsilon
$$
此时得到的闭球列 $\mathcal{B}_{1}, \dots, \mathcal{B}_{n}$ 即满足要求.

**推论**. 设 $E\subset \mathbb{R}^{d}$, 其外测度 $m^{*}(E)\lt \infty$, $\mathcal{B}$ 是 $E$ 的 Vitali 覆盖, 则对于 $\forall \epsilon\gt 0$, 存在有限个 $\mathcal{B}$ 中的球 $I_{1}, \dots I_{n}\in \mathcal{B}$, 使得
$$
m^{*}(E-\bigcup\limits_{i=1}^{n}I_{i})\lt \epsilon
$$

证明: 对于开球和半开的球, 它们和它们的闭包具有相同的测度, 因此考虑它们的闭包所构成的 Vitali 覆盖, 不难得出此结论.

Vitali 有限覆盖定理还有另一种证法:

若 $\mathcal{B}$ 是 $\mathbb{R}^{n}$ 中的一族闭球, 且含于开集 $G$, $m^{*}(G)\lt \infty$. 显然闭球的半径是有界的, 即 $\sup\limits_{B\in \mathcal{B}}r(B)\lt \infty$. 从 $\mathcal{B}$ 中任取一个闭球记为 $B_{0}$. 在剩余的闭球中, 选取 $B_{1}$ 满足: $r(B_{1})\geq \frac{1}{2}\lambda_{1}$, 其中 $\lambda_{1} = \sup\{r(B)|B\cap B_{0}=\emptyset,B\in \mathcal{B}\}$, ..., 选取  $B_{k}$ 满足: $r(B_{k})\geq \frac{1}{2}\lambda_{k}$, 其中 $\lambda_{k} = \sup\{r(B)|B\cap B_{i}=\emptyset, i=0,\dots, k-1,B\in \mathcal{B}\}$ (如果找不到可以记为空集), 继续这个过程, 得到一列闭球 $\hat{\mathcal{B}}=\{B_{0},B_{1}, \dots\}$ (可能是有限个或可列个). 由 $G$ 是测度有限的开集可知, $\sum\limits_{i=0}^{\infty}m(B_{i})\leq m(G)\lt \infty$, 因此当 $n\rightarrow \infty$ 时闭球的半径趋于 $0$, 因为 $r(B_{k})\geq \frac{1}{2}\lambda_{k}$, 所以 $\lim\limits_{k\rightarrow \infty}\lambda_{k}=0$ . 对于$\mathcal{B}$ 中剩余的闭球 $B$, 它必然与 $\hat{\mathcal{B}}$ 中至少一个闭球相交, 否则, $r(B)\lt \lambda_{k}$, $\forall k\in \mathbb{N}^{+}$, 所以 $r(B)\leq \inf\limits_{k\in \mathbb{N}^{+}}\lambda_{k}=0$,  $r(B)=0$, 矛盾.  设 $B$ 与 $B_{1}, \dots, B_{k-1}$ 不相交, 与 $B_{k}$ 相交, $k\geq n+1$, 则对于 $B$ 上的任意一点 $x$,易证 $x$ 到 $B_{k}$ 的中心 $c_{B_{k}}$ 的距离满足
$$
d(x, c_{B_{k}}) \leq 2r(B)+r(B_{k})
$$
易证 $r(B)\leq \lambda_{k}\leq 2r(B_{k})$, 所以
$$
\frac{r(B)}{r(B_{k})}\leq \frac{\lambda_{k}}{r(B_{k})}\leq 2
$$
因此 $d(x,c_{B_{k}})\leq 5r(B_{k})$, 即把 $B_{k}$ 的半径扩张 $5$ 倍, 能够包括 $B$.

证明: 易证存在开集 $G\supset E$, 使得 $m(G)\lt \infty$. 对于 $\forall x\in E$, 显然 $x\in G$, 进而存在 $\delta\gt 0$, 使得 $U(x,\delta)\subset G$,  由 Vitali 覆盖的定义可知, 对于 $\forall \delta'\in (0, \frac{\delta}{3})$, 存在 $I\in \mathcal{B}$, $r(I)\leq \delta'$, 使得 $x\in I$, 此时 $I\subset G$. 由此易证若去除掉 $\mathcal{B}$ 中没有包含于 $G$ 的闭球, 得到的闭球集仍构成 $E$ 的 Vitali 覆盖, 记为 $\mathcal{B}_{G}$, 显然 $\mathcal{B}_{G}$ 中所有闭球的半径有界. 可以按照引言中的方法, 可以构造一个 $\hat{\mathcal{B}}=\{B_{0}, B_{1}, \dots\}$, 由 $\sum\limits_{i=0}^{\infty}m(B_{i})\leq m(G)\lt \infty$ 可知, 对于 $\forall \epsilon'\gt 0$, 必然存在 $n$ 使得
$$
\sum\limits_{i=n+1}^{\infty}m(B_{i})\lt \epsilon'
$$
此时, 对于 $\forall x \in \big(G-\bigcup\limits_{i=1}^{n}B_{i}\big)$, 可知 $\bigcup\limits_{i=1}^{n}B_{i}$ 是闭集, 进而 $\big(G-\bigcup\limits_{i=1}^{n}B_{i}\big)$ 是开集, 所以存在 $\delta''\gt 0$, 使得 $U(x, \delta'')\subset \big(G-\bigcup\limits_{i=1}^{n}B_{i}\big)$, 由 Vitali 覆盖的定义可知, 存在 $\mathcal{B}_{G}$ 中的闭球 $I'$, $r(I')\lt \frac{\delta''}{3}$, 使得 $x\in I'$, 此时 $I'\subset U(x, \delta'')\subset \big(G-\bigcup\limits_{i=1}^{n}B_{i}\big)$. 根据引言中的分析, $I'$ 必然与 $\hat{\mathcal{B}}$ 中至少一个闭球相交, 而显然 $I'$ 又不与 $B_{0},\dots , B_{n}$ 相交, 所以 $I'$ 必然与 $B_{n+1}, \dots$ 中至少一个闭球相交, 设 $B$ 与 $B_{1}, \dots, B_{k-1}$ 不相交, 与 $B_{k}$ 相交, $k\geq n+1$, 此时把 $B_{k}$ 扩张 $5$ 倍可包括 $I'$. 因此 $x\in I'\subset B_{k}^{5r}\subseteq \bigcup\limits_{i=n+1}^{\infty} B_{i}^{5r}$, 进而有 $\big(G-\bigcup\limits_{i=1}^{n}B_{i}\big)\subset \bigcup\limits_{i=n+1}^{\infty}B_{n+1}^{5r}$, $m\big(G-\bigcup\limits_{i=1}^{n}B_{i}\big)\leq 5^{d}\epsilon'$.

特别地, 对于满足 $\epsilon'\leq \frac{\epsilon}{5^{d}}$, 此时
$$
m\big(G-\bigcup\limits_{i=1}^{n}B_{i}\big)\leq \epsilon
$$
此时得到的闭球列 $B_{1}, \dots, B_{n}$ 即满足要求.

**定义**. 设 $f(x)$ 是在 $x_{0}\in \mathbb{R}^{1}$ 的某一邻域内有定义的实值函数. 定义
$$
D^{+}f(x_{0})=\overline{\lim}\limits_{h\rightarrow 0^{+}}\frac{f(x_{0}+h)-f(x_{0})}{h}
$$

$$
D^{-}f(x_{0})=\overline{\lim}\limits_{h\rightarrow 0^{-}}\frac{f(x_{0}+h)-f(x_{0})}{h}
$$

$$
D_{+}f(x_{0})=\underline{\lim}\limits_{h\rightarrow 0^{+}}\frac{f(x_{0}+h)-f(x_{0})}{h}
$$

$$
D_{-}f(x_{0})=\underline{\lim}\limits_{h\rightarrow 0^{-}}\frac{f(x_{0}+h)-f(x_{0})}{h}
$$

分别称之为 $f(x)$ 在 $x_{0}$ 点的右上导数, 左上导数, 右下导数, 左下导数.

显然 $D^{+}f(x_{0})\geq D_{+}f(x_{0})$, $D^{-}f(x_{0})\geq D_{-}f(x_{0})$. $f(x)$ 在 $x_{0}$ 可导等价于$D^{+}f(x_{0}) = D_{+}f(x_{0}) = D^{-}f(x_{0})= D_{-}f(x_{0}) \neq \pm \infty$, 导数值 $f'(x)=D^{+}f(x_{0}) = D_{+}f(x_{0}) = D^{-}f(x_{0})= D_{-}f(x_{0})$

**定理5.1.2**. (Lebesgue) 设 $f(x)$ 是定义在 $[a,b]$ 上的单调递增的实值函数, 则 $f(x)$ 在 $(a,b)$ 上几乎处处可导, 且导函数 $f'(x)$ 在 $[a,b]$ 上可积, 且
$$
\int_{a}^{b}f'(x)\mathrm{d}x\leq f(b)-f(a)
$$
证明: 先证明 $(a,b)$ 上几乎处处有
$$
D^{+}f(x_{0}) = D_{+}f(x_{0}) = D^{-}f(x_{0})= D_{-}f(x_{0})
$$
定义 $E=\{x\in (a,b)|D^{+}f(x)\gt D_{-}f(x)\}$, 易证 $E=\bigcup\limits_{(r,s)\in \mathbb{Q}\times \mathbb{Q}}\{x\in (a,b)|D^{+}f(x)\gt r \gt s\gt D_{-}f(x)\}$ (可能对于某些 $(r,s)$ 为空集, 例如 $r\leq s$ 的 $(r,s)$). 可知 $\mathbb{Q}\times \mathbb{Q}$ 是可列集, $E$ 和 $\mathbb{Q}\times \mathbb{Q}$ 对等, 所以 $E$ 是可列集. 下面证明对于任意一对 $(r,s)$, $r\gt s$, 成立
$$
m^{*}(\{x\in (a,b)|D^{+}f(x)\gt r\gt s \gt D_{-}f(x)\}) =0
$$
记 $A=\{x\in (a,b)|D^{+}f(x)\gt r\gt s \gt D_{-}f(x)\}$, 可知对于 $\forall \epsilon \gt 0$, 存在开集 $G\supset E$, 使得 $m(G)-m^{*}(A)\lt \epsilon$. 对于 $\forall x\in A$, 显然 $x\in G$, 进而存在 $\delta\gt 0$, 使得 $U(x,\delta)\subset G$. 由于 $D_{-}f(x)\lt s$, 因此存在 $\delta' \gt 0$, 使得当 $h\leq \delta'$ 时 $f(x)-f(x-h)\lt sh$, 由此可构造区间族 $\mathcal{U}_{x}=\{[x-h,x]|0\leq h\leq \min(\delta,{\delta'})\}$,  进而得到 $\mathcal{U}=\bigcup\limits_{x\in (a,b)}\mathcal{U}_{x}$, 显然 $\mathcal{U}$ 是 $(a,b)$ 的 Vitali 覆盖, 且其中每个区间都含于 $G$. 由 Vitali 覆盖定理可知, 对于 $\epsilon$, 存在有限个闭区间 $I_{1},\dots, I_{n}$, 其中 $I_{i}=[x_{i}-h_{i}, x_{i}]$, 使得 $m^{*}\big(A-\bigcup\limits_{i=1}^{n}I_{i}\big)\lt \epsilon$. 此时, 由 $\mathcal{U}$ 的定义, 可知
$$
\sum\limits_{i=1}^{n}(f(x_{i})-f(x_{i}-h_{i}))\lt s \sum\limits_{i=1}^{n}h_{i} \lt sm(G)\lt s(m^{*}(A)+\epsilon)
$$
令 $B=A\cap \bigcup\limits_{i=1}^{n}I_{i}^{\circ}$, 则 $A=B\cup \big(A-\bigcup\limits_{i=1}^{n}I_{i}^{\circ}\big)$, 进而有
$$
m^{*}(A)\leq m^{*}(B) + \epsilon
$$
对于 $\forall x\in B$, 显然 $x$ 在某个 $I_{i}$ 中, 因此存在 $\sigma\gt 0$, 使得 $U(x,\sigma)\subset I_{i}$.  由于 $D^{+}f(x)\gt r$, 因此存在 $\sigma' \gt 0$, 使得当 $y\leq \sigma'$ 时 $f(x+y)-f(x)\gt ry$, 由此可构造区间族 $\mathcal{V}_{x}=\{[x,x+y]|0\leq y\leq \min(\sigma,{\sigma'})\}$,  进而得到 $\mathcal{V}=\bigcup\limits_{x\in (a,b)}\mathcal{V}_{x}$, 显然 $\mathcal{V}$ 是 $B$ 的 Vitali 覆盖, 且其中每个区间都含于 $\bigcup\limits_{i=1}^{n}I_{i}^{\circ}$. 由 Vitali 覆盖定理可知, 对于 $\epsilon$, 存在有限个闭区间 $J_{1},\dots, J_{k}$, 其中 $J_{i}=[x'_{i}, x'_{i}+y_{i}]$, 使得 $m^{*}\big(B-\bigcup\limits_{i=1}^{n}J_{i}\big)\lt \epsilon$. 此时 $B=\big(B-\bigcup\limits_{i=1}^{n}J_{i}\big)\cup \bigcup\limits_{i=1}^{n}J_{i}$, 因此 $m^{*}(B)\leq \sum\limits_{i=1}^{k}y_{i}+\epsilon$.

由 $\mathcal{V}$ 的定义, 可知
$$
\sum\limits_{i=1}^{k}(f(x'_{i}+y_{i})-f(x'_{i}))\gt r \sum\limits_{i=1}^{k}y_{i} \geq r (m^{*}(B)-\epsilon) \geq r (m^{*}(A)-2\epsilon)
$$
由于 $f(x)$ 是单调递增的, 且每个 $J_{i}$ 都包含在某个 $I_{j}$ 中, 因此
$$
\sum\limits_{i=1}^{n}(f(x_{i})-f(x_{i}-h_{i})) \geq \sum\limits_{i=1}^{k}(f(x'_{i}+y_{i})-f(x'_{i}))
$$
所以 $s(m^{*}(A)+\epsilon)\geq r(m^{*}(A)-2\epsilon)$, 由 $\epsilon$ 的任意性可知
$$
sm^{*}(A)\geq r m^{*}(A)
$$
若 $m^{*}(A)\gt 0$, 则可以推出 $s\geq r$, 矛盾. 因此 $m^{*}(A)=0$.

进而可推出 $m^{*}(E)=0$, 即在 $(a,b)$ 上几乎处处成立 $D^{+}f(x)\leq D_{-}f(x)$. 定义 $F=\{x\in (a,b)|D^{-}f(x)\gt D_{+}f(x)\}$, 同理可证明 $m^{*}(F)=0$, 即在 $(a,b)$ 上几乎处处成立 $D^{-}f(x)\leq D_{+}f(x)$. 进而在 $(a,b)$ 上几乎处处成立
$$
D_{+}f(x) \leq D^{+}f(x)\leq D_{-}f(x) \leq D^{-}f(x) \leq D_{+}f(x)
$$
即
$$
D^{+}f(x_{0}) = D_{+}f(x_{0}) = D^{-}f(x_{0})= D_{-}f(x_{0})
$$
接下来证明在 $(a,b)$ 上几乎处处成立
$$
D^{+}f(x_{0}) = D_{+}f(x_{0}) = D^{-}f(x_{0})= D_{-}f(x_{0}) \lt \infty
$$
可知存在一个零测集 $E_{0}$, 使得在 $(a,b)-E_{0}$ 有 $D^{+}f(x_{0}) = D_{+}f(x_{0}) = D^{-}f(x_{0})= D_{-}f(x_{0})$. 对 $f(x)$ 进行延拓, 使得 $f(x)=f(a)$, $x\lt a$, $f(x)=f(b)$, $x\gt b$. 定义 $(a,b)$ 上的函数:
$$
g(x)=\begin{cases}
& D^{+}f(x) & \text{if }x\in (a,b)-E_{0} \\
& 0 & \text{if }x\in E_{0} 
\end{cases}
$$

$$
g_{n}(x) = n[f(x+\frac{1}{n})-f(x)], \ \forall n\in \mathbb{N}^{+}
$$

则在 $(a,b)-E_{0}$ 上有 $g_{n}\rightarrow g$ ( $g_{n}\rightarrow g$ a.e. 于 $(a,b)$), 因为 $f(x)$ 是单调递增的, 所以 $g_{n}\geq 0$.
$$
\begin{align}
\int_{a}^{b}g_{n}(x)\mathrm{d}x &= n\int_{a}^{b}f(x+\frac{1}{n})-f(x)\mathrm{d}x \\
&= n\bigg(\int_{a+\frac{1}{n}}^{b+\frac{1}{n}}f(x)\mathrm{d}x - \int_{a}^{b}f(x)\mathrm{d}x\bigg)\\
&= n\bigg(\int_{a+\frac{1}{n}}^{b}f(x)\mathrm{d}x +\int_{b}^{b+\frac{1}{n}}f(x)\mathrm{d}x - \int_{a}^{a+\frac{1}{n}}f(x)\mathrm{d}x-\int_{a+\frac{1}{n}}^{b}f(x)\mathrm{d}x\bigg)\\
&=n\bigg(\int_{b}^{b+\frac{1}{n}}f(x)\mathrm{d}x - \int_{a}^{a+\frac{1}{n}}f(x)\mathrm{d}x\bigg)\\
&= n \bigg(f(b)\cdot \frac{1}{n}-\int_{a}^{a+\frac{1}{n}}f(x)\mathrm{d}x\bigg) \\
&= f(b) - n\int_{a}^{a+\frac{1}{n}}f(x)\mathrm{d}x

\end{align}
$$
所以由 Fatou 定理可知,
$$
\begin{align}
\int_{a}^{b}g(x)\mathrm{d}x &=\int_{a}^{b}\lim\limits_{n\rightarrow \infty}g_{n}(x)\mathrm{d}x\leq \underline{\lim}\limits_{n\rightarrow \infty} \int_{a}^{b}g_{n}(x)\mathrm{d}x \\
&= \underline{\lim}\limits_{n\rightarrow \infty} \bigg(f(b)-n\int_{a}^{a+\frac{1}{n}}f(x)\mathrm{d}x\bigg) \\
&\leq  \underline{\lim}\limits_{n\rightarrow \infty} \bigg(f(b)-n\int_{a}^{a+\frac{1}{n}}a\mathrm{d}x\bigg)\\
&=f(b)-f(a)\lt \infty
\end{align}
$$

所以 $g$ 在 $(a,b)$ 上是可积的, 因此是几乎处处有限的. 可知存在一个零测集 $E_{1}$, 使得在 $(a,b)-E_{1}$ 有 $g(x)\lt \infty$, 易证在 $(a,b)-E_{0}-E_{1}$ 上有 $g(x)=D^{+}f(x) = D_{+}f(x) = D^{-}f(x)= D_{-}f(x) \lt \infty$, 即 $f(x)$ 可导且 $f'(x)=g(x)$. 易证 $E_{0}\cup E_{1}$ 是零测度集, 所以 $f(x)$ 在 $(a,b)$ 上几乎处处可导, 且 $f'(x)=g(x)$ a.e. 于 $(a,b)$. 因此
$$
\int_{a}^{b}f'(x)\mathrm{d}x = \int_{a}^{b}g(x)\mathrm{d}x \leq f(b)-f(a)
$$
证毕.

**定理5.1.3**. (Fubini) 设 $\{f_{n}\}$ 是 $[a,b]$ 上一列单调递增的函数, 并且函数项级数 $\sum\limits_{i=1}^{\infty}f_{i}(x)$ 在 $[a,b]$ 上几乎处处收敛于 $f(x)$, 则 $f(x)$ 在 $(a,b)$ 上几乎处处可导, 且
$$
f'(x)=\sum\limits_{i=1}^{\infty}f_{i}'(x) , \ \text{a.e.}
$$
证明: 定义 $r_{n}(x)=f(x)-\sum\limits_{i=1}^{n}f_{i}(x)$, 即证 $\lim\limits_{n\rightarrow \infty}r_{n}'(x)=0$, a.e. 于 $(a,b)$.

由定理3.1.2, $\{f_{n}\}$ 是 $[a,b]$ 上的可测函数列, 由定理3.2.3, $f$ 是 $[a,b]$ 上的可测函数, 进而 $r_{n}$ 也是 $[a,b]$ 上的可测函数. 设函数项级数 $\sum\limits_{i=1}^{\infty}f_{i}(x)$ 在 $[a,b]$ 除去零测度集 $E_{0}$ 上收敛于 $f(x)$, 即 $f(x)=\sum\limits_{i=1}^{\infty}f_{i}(x)$.  在 $[a,b]-E_{0}$ 上, 显然有 $r_{n}(x)=\sum\limits_{i=n+1}^{\infty}f_{i}(x)$, 且每个 $f_{i}(x)$ 是单调递增函数, 所以 $r_{n}(x)$ 是单调递增函数, 由 Lebesgue 定理可知, $r_{n}(x)$ 在 $(a,b)$ 上几乎处处可导, 设在 $(a,b)-E_{0}$ 除去零测度集 $E_{r_{n}}$ 上可导. 因为 $f_{n}$ 单调递增, 由 Lebesgue 定理可知, $f_{n}$ 在 $(a,b)$ 上几乎处处可导, 设在 $(a,b)$ 除去零测度集 $E_{n}$ 上可导. 因为$f_{n}$ 单调递增, 由 Lebesgue 定理可知, $f(x)$ 单调递增, 所以 $f_{n}$ 在 $(a,b)$ 上几乎处处可导, 设在 $(a,b)$ 除去零测度集 $E_{f}$ 上可导.记 $E=(a,b)-\bigcup\limits_{i=0}^{\infty}E_{n}-\bigcup\limits_{i=1}^{\infty}E_{r_{n}}-E_{f}$, 易证 $\big(\bigcup\limits_{i=0}^{\infty}E_{n}\big)\bigcup \big(\bigcup\limits_{i=1}^{\infty}E_{r_{n}}\big)\bigcup E_{f}$ 是零测度集. 在 $E$ 上有
$$
f'(x)=\sum\limits_{i=1}^{n}f_{i}'(x)+r_{n}'(x)
$$

$$
r_{n}'(x)=f_{n}(x)+r_{n+1}'(x)\geq r_{n+1}'(x),\ \forall n\in \mathbb{N}^{+}
$$

则 $\{r_{n}'\}$ 在 $E$ 上是非负的单调递减函数列, $r_{n}'\leq r_{1}'$. 由单调有界可知, 存在极限函数 $r'=\lim\limits_{n \rightarrow \infty}r_{n}'$. 由控制有界定理可知
$$
\int_{E}r'(x)\mathrm{d}x = \lim\limits_{n\rightarrow \infty}\int_{E}r_{n}'(x)\mathrm{d}x
$$
可知 $r_{n}(x)$ 在 $E$ 上单调递增, 由 Lebesgue 定理有
$$
\int_{E}r_{n}'(x)\mathrm{d}x \leq r_{n}(b)-r_{n}(a)
$$
因此
$$
\int_{E}r'(x)\mathrm{d}x = \lim\limits_{n\rightarrow \infty}\int_{E}r_{n}'(x)\mathrm{d}x \leq \lim\limits_{n\rightarrow \infty} (r_{n}(b)-r_{n}(a)) = 0
$$
由定理4.2.7可知, $r'(x)=0$ a.e. 于 $E$, 显然也 a.e. 于 $(a,b)$, 证毕.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      

## 5.2 有界变差函数 (Functions of Bounded Variation)

**定义**. 设 $f(x)$ 是定义在区间 $[a,b]$ 上的实值函数, 若存在 $M\geq 0$, 使得对 $[a,b]$ 上的任一分割 $T$: $a=x_{0}\lt x_{1}\lt \cdots \lt x_{n}=b$, 总有
$$
\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|\leq M
$$
则称 $f(x)$ 是 $[a,b]$ 上的有界变差函数, $[a,b]$ 上的有界变差函数全体构成的集合记为 $BV[a,b]$. 称 $\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|$ 为分割 $T$ 对应的全变差. 记所有分割对应的全变差的上确界为

$$
\mathop{\mathbf{V}}\limits_{a}^{b}(f)=\sup_{T}\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|
$$
由定义可知, $f\in BV[a,b]$ 等价于 $\mathop{\mathbf{V}}\limits_{a}^{b}(f)\lt \infty$.

**定理5.2.1**. (1) 区间 $[a,b]$ 上的单调函数是有界变差函数.

(2) $f(x)$ 是区间 $[a,b]$ 上的单调函数, 且满足 Lipschitz 条件
$$
|f(x_{i})-f(x_{i-1})|\leq M |x_{1}-x_{2}|, \forall x_{1},x_{2}\in [a,b]
$$
则 $f(x)$ 是有界变差函数.

证明: (1) 设 $f(x)$ 是 $[a,b]$ 上是单调递增的函数, 则对于 $[a,b]$ 上的任一分割 $T$: $a=x_{0}\lt x_{1}\lt \cdots \lt x_{n}=b$, 总有
$$
\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|=\sum\limits_{i=1}^{n}f(x_{i})-f(x_{i-1})=f(b)-f(a)
$$
因此 $f(x)$ 是 $[a,b]$ 上的有界变差函数.  $f(x)$ 是 $[a,b]$ 上是单调递减的函数的情况可以类似证明.



(2) 对于 $[a,b]$ 上的任一分割 $T$: $a=x_{0}\lt x_{1}\lt \cdots \lt x_{n}=b$, 总有
$$
\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|=\leq M\sum\limits_{i=1}^{n}|x_{i}-x_{i-1}|=M(b-a)
$$
所以 $f(x)$ 是有界变差函数.



> 连续函数不一定是有界变差函数, 是连续函数但不是有界变差函数的例子: 设 $f(x)=x\sin\frac{\pi}{x}$, $0\lt x \leq 1$, $f(0)=0$, 则 $f(x)$ 是 $[0,1]$ 上的连续函数, 但 $f(x)$ 在 $[0,1]$ 上不是有界变差函数. 对于任意 $n\in\mathbb{N}^{+}$, 作 $[0,1]$ 的分割 $\{x_{i}\}_{i=0}^{n}$:
> $$
> 0=0\lt\frac{2}{2n-1}\lt\frac{2}{2n-3}\lt \cdots \lt\frac{2}{5}\lt\frac{2}{3} \lt 1=1
> $$
> 此时  $\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|=\frac{2}{2n-1}+(\frac{2}{2n-1}+\frac{2}{2n-3})+\cdots+(\frac{2}{5}+\frac{2}{3})+\frac{2}{3}=2\sum\limits_{i=1}^{n}\frac{2}{2i-1}\geq 2\sum\limits_{i=2}^{n}\frac{1}{i}$, 由数学分析的知识可以证明, 级数 $\sum\limits_{i=2}^{n}\frac{1}{i}$ 不收敛, 因此当 $n$ 趋于 $\infty$ 时, $\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|$ 趋于 $\infty$, 因此 $f\notin BV[0,1]$.
>
> 有界变差函数不一定是连续函数, 例如: $f(x)=\begin{cases}&0&x\in [-1,0]\\&1&x\in (0,1]\end{cases}$, 它是单调递增的函数, 因此是有界变差函数, 但它不是连续函数. 

**定理5.2.2**. 下面给出有界变差函数的若干性质:

(1) 有界变差函数是有界函数. 

(2) 若 $f\in BV[a,b]$, $\alpha\in \mathbb{R}^{1}$, 则 $\alpha f\in BV[a,b]$, 并且
$$
\mathop{\mathbf{V}}\limits_{a}^{b}(\alpha f)= |\alpha|\mathop{\mathbf{V}}\limits_{a}^{b}(f)
$$
(3) 若 $f,g\in BV[a,b]$, 则 $f+g\in BV[a,b]$, 并且
$$
\mathop{\mathbf{V}}\limits_{a}^{b}(f+g)\leq\mathop{\mathbf{V}}\limits_{a}^{b}(f)+\mathop{\mathbf{V}}\limits_{a}^{b}(g)
$$
(4) 若 $f,g\in BV[a,b]$, 则 $fg\in BV[a,b]$.

(5) 若 $f\in BV[a,b]$, 对于 $\forall c\in [a,b]$, $f\in BV[a,c]$, $f\in BV[c,b]$, 且
$$
\mathop{\mathbf{V}}\limits_{a}^{b}(f)=\mathop{\mathbf{V}}\limits_{a}^{c}(f)+\mathop{\mathbf{V}}\limits_{c}^{b}(f)
$$
(6) 若 $f\in BV[a,b]$, 对于 $\forall c, \forall d\in [a,b]$, $c\lt d$, $f\in BV[c,d]$.

证明: (1) 如果 $f(x)$ 在 $[a,b]$ 上无界, 则对于 $\forall M\geq 0$, 存在 $\xi\in [a,b]$, 使得 $|f(\xi)|\geq M$ , 存在分割 $T: 0\leq \xi\leq 1$, $|f(\xi)-f(a)|+|f(b)-f(\xi)|\geq 2|f(\xi)|-|f(a)|-|f(b)|\geq M-|f(a)|-|f(b)|$, 显然 $f(x)$ 不可能是有界变差函数.

(2) 可知存在 $M\geq 0$, 使得对 $[a,b]$ 上的任一分割 $T$: $a=x_{0}\lt x_{1}\lt \cdots \lt x_{n}=b$, 总有
$$
\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|\leq M
$$
 则
$$
\sum\limits_{i=1}^{n}|\alpha f(x_{i})-\alpha f(x_{i-1})|=|\alpha|\sum\limits_{i=1}^{n}| f(x_{i})- f(x_{i-1})|\leq |\alpha| M
$$
显然 $\alpha f\in BV[a,b]$, 并且
$$
\mathop{\mathbf{V}}\limits_{a}^{b}(\alpha f)=\sup_{T}\sum\limits_{i=1}^{n}|\alpha f(x_{i})-\alpha f(x_{i-1})|=|\alpha|\sup_{T}\sum\limits_{i=1}^{n}| f(x_{i})- f(x_{i-1})|=|\alpha|\mathop{\mathbf{V}}\limits_{a}^{b}(f)
$$
因此
$$
\mathop{\mathbf{V}}\limits_{a}^{b}(\alpha f)= |\alpha|\mathop{\mathbf{V}}\limits_{a}^{b}(f)
$$
(3) 对于 $[a,b]$ 上的任一分割 $T$: $a=x_{0}\lt x_{1}\lt \cdots \lt x_{n}=b$,  有
$$
\sum\limits_{i=1}^{n}|f(x_{i})+g(x_{i})-f(x_{i-1})-g(x_{i-1})|\leq \sum\limits_{i=1}^{n} |f(x_{i})-f(x_{i-1})|+\sum\limits_{i=1}^{n} |g(x_{i})-g(x_{i-1})| \leq \mathop{\mathbf{V}}\limits_{a}^{b}(f)+\mathop{\mathbf{V}}\limits_{a}^{b}(g)
$$
因此 $f+g\in BV[a,b]$, 并且
$$
\mathop{\mathbf{V}}\limits_{a}^{b}(f+g)\leq\mathop{\mathbf{V}}\limits_{a}^{b}(f)+\mathop{\mathbf{V}}\limits_{a}^{b}(g)
$$
(4) 由(1)中的结论, $f,g$ 都是有界函数, 因此存在 $M\geq 0$ 使得 $|f|\leq M$, $|g|\leq M$. 对于 $[a,b]$ 上的任一分割 $T$: $a=x_{0}\lt x_{1}\lt \cdots \lt x_{n}=b$,  有
$$
\begin{align}
\sum\limits_{i=1}^{n}|f(x_{i})g(x_{i})-f(x_{i-1})g(x_{i-1})|
&= \sum\limits_{i=1}^{n}|f(x_{i})g(x_{i})-f(x_{i})g(x_{i-1})+f(x_{i})g(x_{i-1})-f(x_{i-1})g(x_{i-1})| \\
&\leq \sum\limits_{i=1}^{n}|f(x_{i})g(x_{i})-f(x_{i})g(x_{i-1})|+\sum\limits_{i=1}^{n}|f(x_{i})g(x_{i-1})-f(x_{i-1})g(x_{i-1})|\\
&\leq \sum\limits_{i=1}^{n}|f(x_{i})||g(x_{i})-g(x_{i-1})|+\sum\limits_{i=1}^{n}|g(x_{i-1})||f(x_{i})-f(x_{i-1})|\\
&\leq M\sum\limits_{i=1}^{n}|g(x_{i})-g(x_{i})|+M\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i})|\\
&\leq M (\mathop{\mathbf{V}}\limits_{a}^{b}(f+g)+\mathop{\mathbf{V}}\limits_{a}^{b}(f+g))
\end{align}
$$
因此有 $fg\in BV[a,b]$.

(5) 对于 $[a,c]$ 的任一分割 $\{x_{i}\}_{i=0}^{n}$, 和 $[c,b]$ 的任一分割 $\{x_{i}'\}_{i=1}^{m}$, 把它们合并后得到 $a=x_{0}\lt\cdots\lt x_{n}=c=x_{0}'\lt\cdots\lt x_{m}'=b$, 此时有
$$
\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|+\sum\limits_{i=1}^{m}|f(x_{i}')-f(x_{i-1}')| \leq \mathop{\mathbf{V}}\limits_{a}^{b}(f)
$$
因此 $\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|\leq \mathop{\mathbf{V}}\limits_{a}^{c}(f)$, $\sum\limits_{i=1}^{m}|f(x_{i}')-f(x_{i-1}')|\leq \mathop{\mathbf{V}}\limits_{c}^{b}(f)$, 进而有 $f\in BV[a,c]$, $f\in BV[c,b]$
$$
\mathop{\mathbf{V}}\limits_{a}^{c}(f)+\mathop{\mathbf{V}}\limits_{c}^{b}(f)\leq \mathop{\mathbf{V}}\limits_{a}^{b}(f)
$$
接下来证明 $\mathop{\mathbf{V}}\limits_{a}^{c}(f)+\mathop{\mathbf{V}}\limits_{c}^{b}(f)\geq \mathop{\mathbf{V}}\limits_{a}^{b}(f)$: 对于 $\forall \epsilon\gt 0$, 存在 [a,b] 的一个分割 $T$: $a=x_{0}\lt x_{1}\lt \cdots \lt x_{n}=b$, 使得
$$
\sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|\geq \mathop{\mathbf{V}}\limits_{a}^{b}(f)-\epsilon
$$
在 $T$ 中插入分点 $c$ (如果之前没有的话), 则分别得到区间 $[a,c]$ 和 $[c,b]$ 的两个分割 $a=x_{0}\lt \cdots\lt x_{k} \leq c$ 和 $c\lt x_{k+1}\lt \cdots\lt x_{n}=c$, 进而有
$$
\begin{align}
\mathop{\mathbf{V}}\limits_{a}^{b}(f)-\epsilon &\leq \sum\limits_{i=1}^{n}|f(x_{i})-f(x_{i-1})|\\
&\leq \sum\limits_{i=1}^{k}|f(x_{i})-f(x_{i-1})| + |f(c)-f(x_{k})| + |f(x_{k+1}-f(x_{k}))|+\sum\limits_{i=k+1}^{n}|f(x_{i})-f(x_{i-1})|\\
&\leq \mathop{\mathbf{V}}\limits_{a}^{c}(f) + \mathop{\mathbf{V}}\limits_{c}^{b}(f)
\end{align}
$$
由 $\epsilon$ 的任意性可知 $\mathop{\mathbf{V}}\limits_{a}^{c}(f)+\mathop{\mathbf{V}}\limits_{c}^{b}(f)\geq \mathop{\mathbf{V}}\limits_{a}^{b}(f)$.

(6) 由(5)可知 $f\in BV[c,b]$, 对于 $[c,b]$ 再次应用(5), 可知 $f\in BV[c,d]$. 

定义. 由(5)的结论可知, $\mathop{\mathbf{V}}\limits_{a}^{c}(f)$ 可以看作关于 $c$ 的函数, 称为 $f(x)$ 的变差函数, 可以记为 $\mathop{\mathbf{V}}\limits_{a}^{x}(f)$, $\forall x\in [a,b]$. 显然 $\mathop{\mathbf{V}}\limits_{a}^{x}(f)$ 是单调递增的函数, 因为对于任意 $x_{1},x_{2}\in [a,b]$, $x_{1}\lt x_{2}$, 有
$$
\mathop{\mathbf{V}}\limits_{a}^{x_{2}}(f)=\mathop{\mathbf{V}}\limits_{a}^{x_{1}}(f)+\mathop{\mathbf{V}}\limits_{x_{1}}^{x_{2}}(f)\geq \mathop{\mathbf{V}}\limits_{a}^{x_{1}}(f)
$$
> 定理的(2), (3)结论表明有界变差函数的线性组合仍是有界变差函数.

**定理5.2.3**. (Jordan 分解定理) $f\in [a,b]$ 的充要条件是 $f(x)$ 可以表示为
$$
f(x)=g(x)-h(x)
$$
其中 $g(x)$ 和 $h(x)$ 都是 $[a,b]$ 上的单调递增的实值函数.

证明: 充分性: 由定理5.2.1,  $g(x), h(x)\in BV[a,b]$, 由定理5.2.2可知, $f(x)$ 是有界变差函数.

必要性: 定义
$$
g(x)=\frac{1}{2}(\mathop{\mathbf{V}}\limits_{a}^{x}(f)+f(x))
$$

$$
h(x)= \frac{1}{2}(\mathop{\mathbf{V}}\limits_{a}^{x}(f)-f(x))
$$

显然 $f(x)=g(x)+h(x)$, 接下来证明 $g(x)$ 和 $h(x)$ 都是单调递增函数, 对于任意 $x_{1},x_{2}\in [a,b]$, $x_{1}\lt x_{2}$, 有 $f(x)\in BV[x_{1},x_{2}]$, 
$$
|f(x_{1})-f(x_{2})|\leq \mathop{\mathbf{V}}\limits_{x_{1}}^{x_{2}}(f)=\mathop{\mathbf{V}}\limits_{a}^{x_{2}}(f) - \mathop{\mathbf{V}}\limits_{a}^{x_{1}}(f)
$$
因此
$$
\mathop{\mathbf{V}}\limits_{a}^{x_{2}}(f) - \mathop{\mathbf{V}}\limits_{a}^{x_{1}}(f)\geq f(x_{1})-f(x_{2})
$$

$$
\mathop{\mathbf{V}}\limits_{a}^{x_{2}}(f) - \mathop{\mathbf{V}}\limits_{a}^{x_{1}}(f)\geq f(x_{2})-f(x_{1})
$$

整理得到
$$
\mathop{\mathbf{V}}\limits_{a}^{x_{2}}(f) + f(x_{2}) \geq \mathop{\mathbf{V}}\limits_{a}^{x_{1}}(f) + f(x_{1})
$$

$$
\mathop{\mathbf{V}}\limits_{a}^{x_{2}}(f) - f(x_{2}) \geq \mathop{\mathbf{V}}\limits_{a}^{x_{1}}(f) - f(x_{1})
$$

所以 $g(x)$ 和 $h(x)$ 都是单调递增函数.

**推论**. 若 $f(x)\in BV[a,b]$, 则

(1) $f(x)$ 的间断点的全体是可数集.

(2) $f(x)$ 在 $[a,b]$ 上是黎曼可积的.

(3) $f(x)$ 在 $(a,b)$ 上几乎处处可导且 $f'(x)$ 在 $[a,b]$ 上是可积的.

证明: 结合4.4节的知识可以得证.

**定理5.2.4**. 设 $f\in BV[a,b]$, 则 $\mathop{\mathbf{V}}\limits_{a}^{x}(f)$ 在 $[a,b)$ 上右连续的充要条件是 $f(x)$ 在 $[a,b)$ 上是右连续的.

证明: 充分性: 即证明对于 $\forall x_{0}\in [a,b)$ 满足: 对于 $\forall \epsilon \gt 0$, 存在 $\delta \gt 0$, 使得当 $x\in [x_{0},x_{0}+\delta]$ 时, 有 $|\mathop{\mathbf{V}}\limits_{a}^{x}(f)-\mathop{\mathbf{V}}\limits_{a}^{x_{0}}(f)|\leq \epsilon$.

若 $f(x)$ 在 $[a,b)$ 上是右连续的, 则对于 $\forall x_{0}\in [a,b)$ 满足: 对于 $\forall \epsilon'\gt 0$, 存在 $\delta' \gt 0$, 使得当 $x\in [x_{0},x_{0}+\delta']$ 时, 有 $|f(x)-f(x_{0})|\leq \epsilon'$. 由定义可知, 存在 $[x_{0},x_{0}+\delta]$ 上的分割 $x_{0}=t_{0}\lt \cdots \lt t_{n}=x_{0}+\delta$, 使得 $\sum\limits_{i=1}^{n}|f(t_{i})-f(t_{i-1})|\gt\mathop{\mathbf{V}}\limits_{x_{0}}^{x_{0}+\delta}(f)-\epsilon'$. 显然 $\sum\limits_{i=2}^{n}|f(t_{i})-f(t_{i-1})|\leq\mathop{\mathbf{V}}\limits_{t_{1}}^{x_{0}+\delta}(f)$. 进而有
$$
\mathop{\mathbf{V}}\limits_{x_{0}}^{x_{0}+\delta}(f)-\epsilon'-\mathop{\mathbf{V}}\limits_{t_{1}}^{x_{0}+\delta}(f) \leq \sum\limits_{i=1}^{n}|f(t_{i})-f(t_{i-1})|-\sum\limits_{i=2}^{n}|f(t_{i})-f(t_{i-1})|= |f(t_{1})-f(t_{0})|
$$
因为 $|t_{1}-x_{0}|\leq \delta$, 因此有
$$
\mathop{\mathbf{V}}\limits_{x_{0}}^{t_{1}}(f)\leq |f(t_{1})-f(t_{0})| + \epsilon' \leq 2 \epsilon'
$$
由变差函数的单调性, 可知对于 $\forall t\in [x_{0}, t_{1}]$,
$$
\mathop{\mathbf{V}}\limits_{a}^{t}(f)-\mathop{\mathbf{V}}\limits_{a}^{x_{0}}(f)=\mathop{\mathbf{V}}\limits_{x_{0}}^{t}(f)\leq \mathop{\mathbf{V}}\limits_{x_{0}}^{t_{1}}(f) \leq 2 \epsilon'
$$
取 $\epsilon'=\frac{\epsilon}{2}$, 此时有
$$
\mathop{\mathbf{V}}\limits_{a}^{t}(f)-\mathop{\mathbf{V}}\limits_{a}^{x_{0}} \leq \epsilon
$$
必要性: 若 $\mathop{\mathbf{V}}\limits_{a}^{x}(f)$ 在 $[a,b)$ 上右连续, 则对于 $\forall x_{0}\in [a,b)$ 满足: 对于 $\forall \epsilon \gt 0$, 存在 $\delta \gt 0$, 使得当 $x\in [x_{0},x_{0}+\delta]$ 时, 有 $\mathop{\mathbf{V}}\limits_{a}^{x}(f)-\mathop{\mathbf{V}}\limits_{a}^{x_{0}}(f)\leq \epsilon$. 此时
$$
|f(x)-f(x_{0})|\leq \mathop{\mathbf{V}}\limits_{x}^{x_{0}}(f) =\mathop{\mathbf{V}}\limits_{a}^{x}(f)-\mathop{\mathbf{V}}\limits_{a}^{x_{0}}(f)\leq \epsilon
$$

**推论**. (1) 设 $f\in BV[a,b]$, 则 $\mathop{\mathbf{V}}\limits_{a}^{x}(f)$ 在 $(a,b]$ 上左连续的充要条件是 $f(x)$ 在 $(a,b]$ 上是左连续的.

(2) 设 $f\in BV[a,b]$, 则 $\mathop{\mathbf{V}}\limits_{a}^{x}(f)$ 在 $(a,b)$ 上连续的充要条件是 $f(x)$ 在 $(a,b)$ 上是连续的.

## 5.3 绝对连续函数 (Absolutely Continuous Functions) 与不定积分

### 5.3.1 绝对连续函数

 **定义**. 设 $f(x)$ 是定义在 $[a,b]$ 上的实值函数, 若对于 $\forall \epsilon \gt 0$, 存在 $\delta\gt 0$, 使得对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$, 满足 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$, 有
$$
\sum\limits_{i=1}^{n}|f(b_{i})-f(a_{i})|\leq \epsilon
$$
则称 $f(x)$ 是 $[a,b]$ 上的绝对连续函数. $[a,b]$ 上的绝对连续函数的全体记为 $AC[a,b]$.

**定理5.3.1**. (1) 绝对连续函数是连续函数.

(2) 若 $f$, $g\in AC[a,b]$, $\alpha\in \mathbb{R}^{1}$, 则 $\alpha f, f+g\in AC[a,b]$.

(3) 绝对连续函数是有界变差函数.

(4) 若 $f$, $g\in AC[a,b]$, $\alpha\in \mathbb{R}^{1}$, 则 $fg\in AC[a,b]$.

证明: (1) 设 $f(x)\in AC[a,b]$, 等价于证明: 对于 $\forall x\in [a,b]$, $\forall \epsilon \gt 0$, 存在 $\delta\gt 0$, 使得当 $|x'-x|\leq \delta$ 时, $|f(x')-f(x)|\leq \epsilon$. 由于 $f(x)\in AC[a,b]$, 所以对于 $\epsilon$, 存在 $\delta'\gt 0$,  使得对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$, 满足$\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta'$, 有

$$
\sum\limits_{i=1}^{n}|f(b_{i})-f(a_{i})|\leq \epsilon
$$
所以当 $|x'-x|\leq \delta'$ 时, $|f(x')-f(x)|\leq \epsilon$. 所以 $\delta'$ 即满足要求, 证毕.

(2) 证明 $\alpha f\in AC[a,b]$: 当 $\alpha=0$ 时显然成立, 下面证明 $\alpha\neq 0$ 的情形, 等价于证明对于 $\forall \epsilon \gt 0$, 存在 $\delta\gt 0$, 使得对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$, 满足 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$, 有
$$
\sum\limits_{i=1}^{n}|f(b_{i})-f(a_{i})|\leq \frac{\epsilon}{|\alpha|}
$$
由 $f\in AC[a,b]$ 可知, 对于正实数 $\frac{\epsilon}{|\alpha|}$, 存在 $\delta'\gt 0$, 使得对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$, 满足 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta'$, 有
$$
\sum\limits_{i=1}^{n}|f(b_{i})-f(a_{i})|\leq \frac{\epsilon}{|\alpha|}
$$
显然 $\delta'$ 即满足要求.

证明 $f+g\in AC[a,b]$:  等价于证明对于 $\forall \epsilon \gt 0$, 存在 $\delta\gt 0$, 使得对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$, 当 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$ 时,
$$
\sum\limits_{i=1}^{n}|f(b_{i})+g(b_{i})-f(a_{i})-g(a_{i})|\leq \epsilon
$$
易证对于 $\forall \epsilon' \gt 0$, 存在 $\delta\gt 0$, 使得对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$, 满足 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$, 有
$$
\sum\limits_{i=1}^{n}|f(b_{i})-f(a_{i})|\leq \epsilon'
$$

$$
\sum\limits_{i=1}^{n}|g(b_{i})-g(a_{i})|\leq \epsilon'
$$

此时
$$
\sum\limits_{i=1}^{n}|f(b_{i})+g(b_{i})-f(a_{i})-g(a_{i})|\leq\sum\limits_{i=1}^{n}|f(b_{i})-f(a_{i})|+\sum\limits_{i=1}^{n}|g(b_{i})-g(a_{i})|\leq 2 \epsilon'
$$
特别地, 对于 $\epsilon'=\frac{\epsilon}{2}$, 此时
$$
\sum\limits_{i=1}^{n}|f(b_{i})+g(b_{i})-f(a_{i})-g(a_{i})|\leq \epsilon
$$
(3) 设 $f(x)\in AC[a,b]$, 接下来证明 $f(x)\in BV[a,b]$. 任取正实数 $\epsilon$, 因为 $f(x)\in AC[a,b]$, 所以存在 $\delta\gt 0$, 使得对于 $[a,b]$ 上的任意一族互不相交的开区间 $\{(a_{i},b_{i})\}_{i=1}^{n}$, $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$, 有

$$
\sum\limits_{i=1}^{n}|f(b_{i})-f(a_{i})| \leq \epsilon
$$
 取正整数 $k$ 满足 $(b-a)/k\leq \delta$, 把 $[a,b]$ $k$ 等分, 得到分割 $a=x_{0}\lt\cdots\lt x_{k}=b$, 此时每个子区间 $[x_{i-1},x_{i}]$, $i=1,\dots,k$, 的长度 $x_{i-1}-x_{i}\leq \delta$. 对于任意一个子区间 $[x_{i-1},x_{i}]$, 我们接下来证明: $f(x)\in BV[x_{i-1},x_{i}]$, 且 $\mathop{\mathbf{V}}\limits_{x_{i-1}}^{x_{i}}(f)\leq \epsilon$. 设 $x_{i-1}=y_{0}\lt\cdots\lt y_{m}=x_{i}$ 是 $[x_{i-1},x_{i}]$ 上的任一分割, 由于 $\{[y_{i-1},y_{i}]\}_{i=1}^{m}$ 是 $[a,b]$ 上的任意一族互不相交的开区间 $\{(a_{i},b_{i})\}_{i=1}^{n}$, 且 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$, 所以
$$
\sum\limits_{i=1}^{m} |f(y_{i})-f(y_{i-1})| \leq \epsilon
$$
因此 $f(x)\in BV[x_{i-1},x_{i}]$, 且 $\mathop{\mathbf{V}}\limits_{x_{i-1}}^{x_{i}}(f)\leq \epsilon$. 进而有
$$
\mathop{\mathbf{V}}\limits_{a}^{b}(f)=\sum\limits_{i=1}^{k}\mathop{\mathbf{V}}\limits_{x_{i-1}}^{x_{i}}(f)\leq k\epsilon
$$
因此 $f(x)\in BV[a,b]$.

(4) 等价于证明:对于 $\forall \epsilon \gt 0$, 存在 $\delta\gt 0$, 使得对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$,  满足 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$, 有
$$
\sum\limits_{i=1}^{n}|f(b_{i})g(b_{i})-f(a_{i})g(a_{i})|\leq \epsilon
$$
由(3)和定理5.2.2, 可知 $f,g$ 都是有界函数, 进而存在 $M\geq 0$, 使得 $|f|\leq |M|$, $|g|\leq M$, 由 $f,g\in AC[a,b]$, 可知对于 $\forall \epsilon'\gt 0$, 存在 $\delta\gt 0$, 使得 
$$
\sum\limits_{i=1}^{n}|f(b_{i})-f(a_{i})|\leq \epsilon'
$$

$$
\sum\limits_{i=1}^{n}|g(b_{i})-g(a_{i})|\leq \epsilon'
$$

此时, 同定理5.2.2(4)的证明, 可知
$$
\sum\limits_{i=1}^{n}|f(b_{i})g(b_{i})-f(a_{i})g(a_{i})|\leq 2M\epsilon'
$$
特别地, 对于 $\epsilon'=\epsilon/2M$, 有
$$
\sum\limits_{i=1}^{n}|f(b_{i})g(b_{i})-f(a_{i})g(a_{i})|\leq \epsilon
$$
证毕.

**定理5.3.2**. $f(x)$ 在 $[a,b]$ 上满足 Lipschitz 条件, 则 $f\in AC[a,b]$.

证明: 可知对于 $\forall \delta\gt 0$, 有: 对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$, 满足 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$, 有
$$
\sum\limits_{i=1}^{n}|f(b_{i})-f(a_{i})|\leq M\delta
$$
所以对于 $\forall \epsilon \gt 0$, 存在正实数 $\epsilon/M$, 使得对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$, 满足 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$, 有
$$
\sum\limits_{i=1}^{n}|f(b_{i})-f(a_{i})|\leq \epsilon
$$
证毕.

### 5.3.2 可积函数的变上限积分

**定理5.3.3**. 设 $f$ 是 $[a,b]$ 上的可积函数, 则 $f$ 的变上限积分 
$$
F(x)=\int_{a}^{x}f(t)\mathrm{d}t
$$
是 $[a,b]$ 上的绝对连续函数.

证明: 即证明对于 $\forall \epsilon \gt 0$, 存在 $\delta\gt 0$, 使得对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$, 满足 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$, 有

$$
\sum\limits_{i=1}^{n}|F(b_{i})-F(a_{i})|\leq \epsilon
$$
由积分的绝对连续性, 对于 $\epsilon$, 存在 $\delta \gt 0$, 使得对于 $[a,b]$ 中的任意可测子集 $A$, $m(A)\leq \delta$, 有 $\int_{A}|f(x)|\mathrm{d}x\leq \epsilon$. 此时, 对于 $[a,b]$ 上任意有限个互不相交的开区间 $\{(a_{i}, b_{i})\}_{i=1}^{n}$, 当 $\sum\limits_{i=1}^{n}(b_{i}-a_{i})\leq \delta$ 时, $m\big(\bigcup\limits_{i=1}^{n}[a_{i},b_{i}]\big)\leq \delta$, 因此
$$
\int_{\bigcup\limits_{i=1}^{n}[a_{i},b_{i}]}|f(x)|\mathrm{d}x=\sum\limits_{i=1}^{n}\int_{a_{i}}^{b_{i}}|f(x)|\mathrm{d}x\leq \epsilon
$$
进而有,
$$
\sum\limits_{i=1}^{n}|F(b_{i})-F(a_{i})|=\sum\limits_{i=1}^{n}|\int_{a_{i}}^{b_{i}}f(x)\mathrm{d}x|\leq \sum\limits_{i=1}^{n}\int_{a_{i}}^{b_{i}}|f(x)|\mathrm{d}x\leq \epsilon
$$
证毕.

**引理5.3.1**. 设 $f$ 是 $[a,b]$ 上的可积函数, 则 $f$ 的变上限积分 
$$
F(x)=\int_{a}^{x}f(t)\mathrm{d}t
$$
在 $(a,b)$ 上几乎处处可导, 且满足: $\int_{a}^{b}|F'(x)|\mathrm{d}x\leq \int_{a}^{b}|f(x)|\mathrm{d}x$.

证明: 记 $F^{+}(x)=\int_{a}^{x}f^{+}(t)\mathrm{d}t$, $F^{+}(x)=\int_{a}^{x}f^{-}(t)\mathrm{d}t$, 显然, $F(x)=F^{+}(x)-F^{-}(x)$. 由于 $f^{+}$ 和 $f^{-}$ 非负, 对于 $\forall x_{1}\leq x_{2}$, 由定理4.2.4可知, $F^{+}(x_{1})\leq F^{+}(x_{2})$, $F^{-}(x_{1})\leq F^{-}(x_{2})$, 所以 $F^{+}(x)$ 和 $F^{-}(x)$ 是单调递增函数. 由 Lebesgue 定理可知,  $F^{+}(x)$ 和 $F^{-}(x)$ 在 $(a,b)$ 上几乎处处可导, 且
$$
\int_{a}^{b}(F^{+}(x))'\mathrm{d}x\leq F^{+}(b)-F^{+}(a)=F^{+}(b)
$$

$$
\int_{a}^{b}(F^{-}(x))'\mathrm{d}x\leq F^{-}(b) - F^{-}(a) = F^{-}(b)
$$

进而有 $F(x)$ 在 $(a,b)$ 上几乎处处可导, 且
$$
\begin{align}
\int_{a}^{b}|F'(x)|\mathrm{d}x &\leq \int_{a}^{b}|(F^{+}(x))'|\mathrm{d}x + \int_{a}^{b}|(F^{-}(x))'|\mathrm{d}x\\
& = \int_{a}^{b}(F^{+}(x))'\mathrm{d}x + \int_{a}^{b}(F^{-}(x))'\mathrm{d}x \\
& \leq F^{+}(b) + F^{-}(b) \\
&= \int_{a}^{b}f^{+}(x)\mathrm{d}x + \int_{a}^{b}f^{-}(x)\mathrm{d}x \\
&= \int_{a}^{b}|f(x)|\mathrm{d}x
\end{align}
$$
**定理5.3.4**. 设 $f$ 是 $[a,b]$ 上的可积函数, 则 $f$ 的变上限积分 
$$
F(x)=\int_{a}^{x}f(t)\mathrm{d}t
$$
在 $(a,b)$ 上几乎处处可导, 且 $F'(x)=f(x)$ a.e.

证明: 由引理5.3.1可知 $F(x)$ 在 $(a,b)$ 上几乎处处可导, 接下来证明  $F'(x)=f(x)$ a.e. 若可证明 $\int_{a}^{b}|F'(x)-f(x)|\mathrm{d}x=0$, 则由定理4.2.7, 可知 $F'(x)=f(x)$ a.e.

假设 $f(x)$ 是 $[a,b]$ 上的连续函数, 则由数学分析的知识, 可知 $F(x)$ 在 $(a,b)$ 上可导, 且 $F'(x)=f(x)$. 若 $f(x)$ 不是 $[a,b]$ 上的连续函数, 由定理4.5.4可知, 对于 $\forall \epsilon\gt 0$, 存在 $\mathbb{R}^{1}$ 上具有紧支集的连续可积函数 $g(x)$, 使得
$$
\int_{a}^{b}|f(x)-g(x)|\mathrm{d}x\leq \epsilon
$$
记 $G(x)$ 是 $g(x)$ 的变上限积分, 则 $G(x)$ 在 $(a,b)$ 上可导, 且 $G'(x)=g(x)$ a.e., 此时,
$$
\begin{align}
\int_{a}^{b}|F'(x)-f(x)|\mathrm{d}x &=\int_{a}^{b}|F'(x)-f(x)-(G'(x)-g(x))|\mathrm{d}x\\
&\leq \int_{a}^{b}|F'(x)-G'(x)|\mathrm{d}x + \int_{a}^{b}|f(x)-g(x)|\mathrm{d}x \\
&\leq \int_{a}^{b}|\big(\int_{a}^{b}f(t)-g(t)\mathrm{d}t\big)'|\mathrm{d}x + \int_{a}^{b}|f(x)-g(x)|\mathrm{d}x 
\end{align}
$$

因为 $f$, $g$ 都是 $[a,b]$ 上的可积函数, 所以 $f-g$ 是 $[a,b]$ 上的可积函数, 由引理5.3.1可知, 
$$
\int_{a}^{b}|\big(\int_{a}^{b}f(t)-g(t)\mathrm{d}t\big)'|\mathrm{d}x \leq \int_{a}^{b}|f(x)-g(x)|\mathrm{d}x
$$
进而有
$$
\int_{a}^{b}|F'(x)-f(x)|\mathrm{d}x \leq 2 \int_{a}^{b}|f(x)-g(x)|\mathrm{d}x \leq 2\epsilon
$$
由 $\epsilon$ 的任意性可知,  $F'(x)=f(x)$ a.e.

### 5.3.3 Newton-Leibniz 公式

**定理5.3.5**. 设 $f\in AC[a,b]$, 并且在 $(a,b)$ 上 $f'(x)=0$ a.e., 则 $f(x)$ 在 $[a,b]$ 上为常数.

证明: 由于 $f\in AC[a,b]$, 所以对于 $\forall \epsilon\gt 0$, 存在 $\delta\gt 0$, 使得对于 $[a,b]$ 上任意互不相交的区间族 $\{(a_{i},b_{i})\}_{i=1}^{k}$, $\sum\limits_{i=1}^{k}(b_{i}-a_{i})\leq \delta$, 满足 $\sum\limits_{i=1}^{k}|f(x_{i})-f(x_{i-1})|\leq \epsilon$. 存在一个零测度集 $E_{0}$, 使得在 $(a,b)-E_{0}$ 上 $f'(x)=0$. 进而对于 $\forall x\in (a,b)-E_{0}$, 和上文提到的 $\epsilon$, 存在  $\delta'\gt 0$, 使得当 $|h|\leq \delta'$ 时
$$
|\frac{f(x+h)-f(x)}{h}|\leq \epsilon
$$
由此可知当 $0\lt h\leq \delta'$ 时,
$$
\frac{f(x+h)-f(x)}{h}\leq \epsilon
$$
可构造区间族 $\mathcal{U}_{x}=\{[x,h]|0\lt h\leq \delta'\}$, 进而得到 $\mathcal{U}=\bigcup\limits_{x\in (a,b)}\mathcal{U}_{x}$. 易验证区间族 $\mathcal{U}$ 是 $(a,b)$ 的 Vitali 覆盖. 由 Vitali 有限覆盖定理, 对于上文中提到的 $\delta$, 存在 $\mathcal{U}$ 中有限个互不相交的闭区间 $[a_{1},b_{1}]$, $\cdots$, $[a_{k}, b_{k}]$, 使得 $m((a,b)-\bigcup\limits_{i=1}^{k}[a_{i},b_{i}])\leq \delta$. 对于分割 $a\lt a_{1}\lt b_{1}\cdots\lt a_{k}\lt b_{k}\lt b$, 显然有
$$
|f(b)-f(a)|\leq \sum\limits_{i=1}^{k}|f(b_{i})-f(a_{i})|+\sum\limits_{i=2}^{k}|f(a_{i})-f(b_{i-1})|+|f(a_{1})-f(a)|+|f(b)-f(b_{k})|
$$
其中由 $\mathcal{U}$ 的定义可知, $\sum\limits_{i=1}^{k}|f(b_{i})-f(a_{i})|\leq \epsilon(b_{i}-a_{i})\leq (b-a)$. 此外,  $(b_{i-1}, a_{i})$, $i=2,\dots,k$, $(a,a_{1})$, $(b_{k},b)$ 的并集是 $((a,b)-\bigcup\limits_{i=1}^{k}[a_{i},b_{i}])$, 测度不足 $\delta$, 因此有
$$
\sum\limits_{i=2}^{k}|f(a_{i})-f(b_{i-1})|+|f(a_{1})-f(a)|+|f(b)-f(b_{k})|\leq \epsilon
$$
综上有 $|f(b)-f(a)|\leq \epsilon+\epsilon(b-a)$. 由 $\epsilon$ 的任意性可知 $|f(b)-f(a)|=0$.

对于 $\forall c\in (a,b)$, $f\in AC[a,c]$, 并且在 $(a,c)$ 上 $f'(x)=0$ a.e., 根据以上结论可知, $f(a)=f(c)$, 因此 $f(x)$ 在 $[a,b]$ 上为常数.

**定理5.3.6**. (Newton-Leibniz) 设 $f\in AC[a,b]$, 则 $f$ 在 $(a,b)$ 上几乎处处可导且 $f'$ 在 $[a,b]$ 上可积, 且
$$
\int_{a}^{x}f'(t)\mathrm{d}t=f(x)-f(a)
$$
证明: 由定理5.3.1可知, $f(x)$ 是有界变差函数, 由定理5.2.3的推论, $f(x)$ 在 $(a,b)$ 上几乎处处可导, 且 $f'$ 在 $[a,b]$ 上可积. $\int_{a}^{x}f'(t)\mathrm{d}t$ 是 $f'$ 的变上限积分, 由定理5.3.3可知, $\int_{a}^{x}f'(t)\mathrm{d}t\in AC[a,b]$. 由定理5.3.4可知, 在 $(a,b)$ 上 $\int_{a}^{x}f'(t)\mathrm{d}t$ 几乎处处可导且 $\big(\int_{a}^{x}f'(t)\mathrm{d}t\big)'=f'(x)$, a.e. 构造函数
$$
\phi({x})=f(x)-f(a)-\int_{a}^{x}f'(t)\mathrm{d}t
$$
由定理5.2.2可知, $\phi(x)\in AC[a,b]$. 此外有
$$
\phi'(x)=f'(x)-\big(\int_{a}^{x}f'(t)\mathrm{d}t\big)'=0 \ \text{a.e.}
$$
由定理5.3.5可知, $\phi({x})$ 为常数. 代入 $x=a$, 得到 $\phi(a)=0$, 所以 $\phi(x)=0$, 证毕.

综合定理5.3.4和 Newton-Leibniz 公式可知, 若 $f(x)$ 是 $[a,b]$ 上可积的实值函数, 则 $f(x)$ 的变上限积分 $F(x)$ 在 $(a,b)$ 上几乎处处可导且 $F'(x)=f(x)$ a.e., 且满足
$$
\int_{a}^{x}f(t)\mathrm{d}t=F(x)-F(a)
$$
**定理5.3.7**. (分部积分公式) 设 $f,g\in AC[a,b]$, 则成立
$$
\int_{a}^{b}f(x)g'(x)\mathrm{d}x=f(x)g(x)\bigg|_{a}^{b}-\int_{a}^{b}f'(x)g(x)\mathrm{d}x
$$
证明: 由定理5.3.1, $fg\in AC[a,b]$, 由定理5.3.6, 有
$$
f(b)g(b)-f(a)g(a)=\int_{a}^{b}(f(x)g(x))'\mathrm{d}x=\int_{a}^{b}f(x)g'(x)\mathrm{d}x + \int_{a}^{b}f'(x)g(x)\mathrm{d}x
$$
证毕.